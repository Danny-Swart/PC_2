\documentclass{article}

\usepackage{tikz}
\usepackage{pgfplots}
\usepackage{pgfplotstable}
\pgfkeys{/pgf/number format/.cd,fixed,precision=0}
\pgfplotstableset{col sep=comma}

\begin{document}

\begin{figure}[ht]
    \begin{tikzpicture}
        \begin{loglogaxis}[
            xlabel=threads,
            ylabel=Gflops/s,
            legend pos = north west,
            xticklabel style={/pgf/number format/fixed},
            yticklabel style={/pgf/number format/fixed},
            xtick = {1, 2, 4, 8, 16, 32},
            xticklabels = {1, 2, 4, 8, 16, 32},
            ytick = {10, 20, 40, 80, 160, 320, 640},
            yticklabels = {10, 20, 40, 80, 160, 320, 640},
        ]
            \addplot+ [
                error bars/.cd,
                    y explicit,
                    y dir=both,
            ] table [
                x=P,
                y=mean,
                y error plus expr=\thisrow{max}-\thisrow{mean},
                y error minus expr=\thisrow{mean}-\thisrow{min},
            ] {results/stencil_avx2.csv};

            \legend{avx2}
        \end{loglogaxis}
    \end{tikzpicture}
    \caption{Compute rate in Gflops/s for the avx2 version of a three-point stencil. Input size is
             $9990000$ or about $800$ MB per vector, for $300$ iterations. Averaged over $10$ runs,
             with error bars from the slowest to fastest run.}
    \label{fig:avx2}
\end{figure}

\end{document}
